{% extends 'main/layout.html' %}
{% load static %}


{% block title %}
    Settings 
{% endblock %}

{% block content %}

<main style="width: 100%;" class="flex overflow-y-auto w-full" style="height: 100vh;">
    

        <div style="width: 80%;" class="flex-1 overflow-y-auto py-8 px-12 scrollbar-hide dark:text-[#fff]">
            <form method="POST">
            <h2 class="text-2xl font-medium text-left text-black mb-6 dark:text-[#fff]">
                Settings
            </h2>
                {% csrf_token %}
            <!-- Account type -->
            <div class="flex justify-between w-full mb-4">
                <h2 class="text-xl font-medium text-left text-black mb-2 dark:text-[#b8b8b8]">
                    Account Type
                </h2>
                <!-- dropdown input with private or public -->
                <div class="relative inline-block w-32">
                    <select name="account_type" class="block appearance-none w-full bg-white border border-gray-800 hover:border-gray-500 px-4 py-2 pr-8 rounded leading-tight dark:bg-[#1f2022] dark:border-[#333] dark:text-[#a8a8a8]">
                        <option value="Private" {% if settings.account_type == 'Private' %}selected{% endif %}>Private</option>
                        <option value="Public" {% if settings.account_type == 'Public' %}selected{% endif %}>Public</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 ">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />

                        </svg>
                    </div>
                </div>  

            </div>

            <!-- Notifications -->
            <div class="flex justify-between w-full mb-4">
                <h2 class="text-xl font-medium text-left text-black mb-2 dark:border-[#333] dark:text-[#a8a8a8]">
                    Notifications 
                </h2>
                <!-- dropdown input with private or public -->
                <div class="relative inline-block w-32">
                    <select name="notifications" class="block appearance-none w-full bg-white border border-gray-800 hover:border-gray-500 px-4 py-2 pr-8 rounded leading-tight dark:bg-[#1f2022] dark:border-[#333] dark:text-[#a8a8a8]">
                        <option value="On" {% if settings.notifications == 'On' %}selected{% endif %}>On</option>
                        <option value="Off" {% if settings.notifications == 'Off' %}selected{% endif %}>Off</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 ">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />

                        </svg>
                    </div>
                </div>  

            </div>

            <!-- Appearance -->
            <div class="flex justify-between w-full">
                <h2 class="text-xl font-medium text-left text-black mb-2 dark:border-[#333] dark:text-[#a8a8a8]">
                    Appearance 
                </h2>
                <!-- dropdown input with private or public -->
                <div class="relative inline-block w-32">
                    <select name="appearance" class="block appearance-none w-full bg-white border border-gray-800 hover:border-gray-500 px-4 py-2 pr-8 rounded leading-tight dark:bg-[#1f2022] dark:border-[#333] dark:text-[#a8a8a8]">
                        <option value="Dark" {% if settings.appearance == 'Dark' %}selected{% endif %}>Dark</option>
                        <option value="Light" {% if settings.appearance == 'Light' %}selected{% endif %}>Light</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 ">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />

                        </svg>
                    </div>
                </div>  

            </div>
            
            <button type="submit" class="mt-4 bg-[{{player.primary_accent_color}}] text-white py-2 px-4 rounded ">Save</button>
        </form>
        </div>
        
    

        <aside style="width: 450px;"  class="w-80 p-6 overflow-y-auto scrollbar-hide">

            <div class="bg-white p-6 mb-4 rounded-xl border-2 border-gray-200 flex flex-col gap-4 dark:bg-[#1f2022] dark:border-[#333]">
                <h2 class="text-xl font-medium text-left text-black mb-2 dark:text-[#fff]">
                    Account
                </h2>
                <a href="{% url 'edit_profile' %}">
                    <button class="text-l font-semibold text-left text-gray-800  dark:text-[#b8b8b8]">
                        Edit Profile
                    </button>
                </a>

                <a href="{% url 'change_password' %}">
                    <button class="text-l font-semibold text-left text-gray-800 dark:text-[#b8b8b8]">
                      Change Password
                    </button>
                  </a>                  

                  <!-- âœ… No more anchor tag wrapping this -->
                <button onclick="openDeleteModal()" class="text-l font-semibold text-left text-red-500 hover:text-red-600">
                    Delete Account
                </button>

                  
                
            </div>
            <div class="bg-white p-6 mb-4 rounded-xl border-2 border-gray-200 flex flex-col gap-4 dark:bg-[#1f2022] dark:border-[#333]">
                <button class="text-l font-semibold text-left text-gray-800  dark:text-[#b8b8b8]">
                    Invite Friends
                </button>
                <a href="{% url 'logout' %}"><button class="text-l font-semibold text-left text-red-700 hover:text-red-800">
                    Log out
                </button>
                </a>
            </div>
        </aside>
</main>

<!-- Delete Account Modal -->
<div id="deleteAccountModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
    <div class="bg-white dark:bg-[#1f2022] p-6 rounded-xl shadow-lg max-w-md w-full border border-gray-300 dark:border-[#444] relative">
      <h2 class="text-lg font-semibold mb-3 text-black dark:text-white">Delete Account</h2>
      <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Are you sure you want to delete your account? This action is permanent</p>
  
      <!-- Delete form -->
      <form id="deleteAccountForm" method="POST" action="{% url 'delete_account' %}">
        {% csrf_token %}
        <div class="flex justify-end gap-3 mt-4">
          <!-- Cancel Button (no form submission) -->
          <button type="button" onclick="closeDeleteModal()" class="px-4 py-2 text-sm bg-gray-200 dark:bg-[#333] dark:text-white rounded-md">
            Cancel
          </button>
  
          <!-- Delete Button (submits the form) -->
          <button type="submit" class="px-4 py-2 text-sm bg-red-600 text-white rounded-md hover:bg-red-700">
            Delete
          </button>
        </div>
      </form>
    </div>
  </div>
  
  
{% endblock %}

{% block scripts %}
<script>
    function openDeleteModal() {
      document.getElementById("deleteAccountModal").classList.remove("hidden");
      document.getElementById("deleteAccountModal").classList.add("flex");
    }
  
    function closeDeleteModal() {
      document.getElementById("deleteAccountModal").classList.remove("flex");
      document.getElementById("deleteAccountModal").classList.add("hidden");
    }
  
    // Close modal on Esc
    document.addEventListener("keydown", function(e) {
      if (e.key === "Escape") closeDeleteModal();
    });
  </script>
{% endblock %}  